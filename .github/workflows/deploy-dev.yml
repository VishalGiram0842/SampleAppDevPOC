name: Deploy to DEV 

on:
  push:
    branches:
      - dev

permissions:
  contents: read
  actions: write

jobs:
  deploy-dev:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4
      
      - name: Fake deploy to DEV
        run: echo "Simulating DEV deployment for POC..."
      
      - name: Trigger QA automation via API
        uses: actions/github-script@v7
        with:
          github-token: ${{ secrets.AUTOMATION_REPO_TOKEN }}
          script: |
            github.rest.repos.createDispatchEvent({
              owner: 'VishalGiram0842',
              repo: 'SampleRepoForCICD',
              event_type: 'run-dev-tests',
              client_payload: {
                source_repo: context.repo.repo,
                env: 'DEV'
              }
            })
      
      - name: Post Deployment
        run: echo "Deployment completed"
